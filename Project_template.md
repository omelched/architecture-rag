# RAG-бот

## Исследование моделей и инфраструктуры

### Сравнение LLM-моделей

| класс моделей | качество ответов                                        | скорость работы                                     | стоимость владения                            | удобство и простота                                           |
| ------------- | ------------------------------------------------------- | --------------------------------------------------- | --------------------------------------------- | ------------------------------------------------------------- |
| локальные     | ниже решений-"китов", зависит от модели и ее подготовки | низкая, обработка выполняется на мощностях компании | низкая, включает в себя только инфраструктуру | низкие, требует настройки инфраструктуры и внедрения ModelOps |
| облачные      | высокое, модели обучены на больших объёмах данных       | высокая, благодаря публикации в облаке as a service | высокая, цена за каждое обращение             | высокие, требуется лишь интеграция по REST API                |

### Сравнение моделей эмбеддингов

| модель эмбеддинга     | скорость создания индекса                                                                         | качество поиска                                                           | стоимость владения                            |
| --------------------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- | --------------------------------------------- |
| Sentence-Transformers | может быть медленнее по сравнению с облачными моделями, зависит от инфраструктуры и объема данных | может уступать облачным моделям из-за меньшего объёма данных для обучения | низкая, включает в себя только инфраструктуру |
| OpenAI Embeddings     | высокая благодаря публикации в облаке as a service                                                | высокое, большой объем данных для оптимизации алгоритма                   | высокая, цена за каждое обращение             |

### Сравнение векторных баз ChromaDB и FAISS

| векторная БД | скорость поиска и индексации                                                            | сложность внедрения и поддержки                            | удобство в работе                                           | стоимость владения                                              |
| ------------ | --------------------------------------------------------------------------------------- | ---------------------------------------------------------- | ----------------------------------------------------------- | --------------------------------------------------------------- |
| ChromaDB     | может быть медленнее по сравнению с FAISS из-за меньшей оптимизации и меньших мощностей | низкая, предоставляет user-friendly инструменты для работы | высокое, предоставляет user-friendly инструменты для работы | низкая, может быть развёрнута на локальных серверах             |
| FAISS        | высокая благодаря оптимизации и мощностям                                               | высокая, требует более сложных настроек и интеграции       | низкое, сложнее в освоении и использовании                  | высокая, может требовать более мощных серверов и инфраструктуры |

### Выбор конфигурации сервера

| конфигурация | LLM-модель                                    | модель эмбеддинга                                             | Векторная БД   | CPU    | GPU   | RAM   | Описание                                                                                                                                         |
| ------------ | --------------------------------------------- | ------------------------------------------------------------- | -------------- | ------ | ----- | ----- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| облачная     | облачная (OpenAi, YandexGPT)                  | облачная (OpenAi Embeddings, Yandex Model Gallery Embeddings) | Quadrant (aaS) | 1 ядро | -     | 4 гб  | Инфраструктура требуется только для работы самого бота. Все ML-процессы выполняются внешними поставщиками и для сервера они обычные IO-операции. |
| гибридная    | облачная (OpenAi, YandexGPT)                  | локальная (Sentence-Transformers)                             | ChromaDB       | 4 ядра | -     | 16 гб | Генерация эмбедингов и хранение векторов выполняется на сервере, но LLM-модель остается "от вендора".                                            |
| локальная    | локальная разработка (дообучение HuggingFace) | локальная (Sentence-Transformers)                             | FAISS          | 4 ядра | 16 гб | 16 гб | LLM-модель находится внутри контура, поэтому дообучение и выполнение запросов потребует GPU.                                                     |

## Создание векторного индекса базы знаний

Модель: `all-MiniLM-L6-v2`
База знаний: 148 Markdown-документов с интервью из игры "Death Stranding"
Кол-во чанков: 942
Время индексации: 15.8431 сек.

